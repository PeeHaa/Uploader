(function(){var g=window.XMLHttpRequest;var a=!!window.controllers;var j=window.document.all&&!window.opera;var k=j&&window.navigator.userAgent.match(/MSIE 7.0/);function d(){this._object=g&&!k?new g:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function c(){return new d}c.prototype=d.prototype;if(a&&g.wrapped){c.wrapped=g.wrapped}c.UNSENT=0;c.OPENED=1;c.HEADERS_RECEIVED=2;c.LOADING=3;c.DONE=4;c.prototype.UNSENT=c.UNSENT;c.prototype.OPENED=c.OPENED;c.prototype.HEADERS_RECEIVED=c.HEADERS_RECEIVED;c.prototype.LOADING=c.LOADING;c.prototype.DONE=c.DONE;c.prototype.readyState=c.UNSENT;c.prototype.responseText="";c.prototype.responseXML=null;c.prototype.status=0;c.prototype.statusText="";c.prototype.priority="NORMAL";c.prototype.onreadystatechange=null;c.onreadystatechange=null;c.onopen=null;c.onsend=null;c.onabort=null;c.prototype.open=function(q,l,n,s,o){var p=q.toLowerCase();if((p=="connect")||(p=="trace")||(p=="track")){throw new Error(18)}delete this._headers;if(arguments.length<3){n=true}this._async=n;var m=this;var r=this.readyState;var t=null;if(j&&n){t=function(){if(r!=c.DONE){e(m);m.abort()}};window.attachEvent("onunload",t)}if(c.onopen){c.onopen.apply(this,arguments)}if(arguments.length>4){this._object.open(q,l,n,s,o)}else{if(arguments.length>3){this._object.open(q,l,n,s)}else{this._object.open(q,l,n)}}this.readyState=c.OPENED;b(this);this._object.onreadystatechange=function(){if(a&&!n){return}m.readyState=m._object.readyState;h(m);if(m._aborted){m.readyState=c.UNSENT;return}if(m.readyState==c.DONE){delete m._data;e(m);if(j&&n){window.detachEvent("onunload",t)}if(r!=m.readyState){b(m)}r=m.readyState}}};c.prototype.send=function(l){if(c.onsend){c.onsend.apply(this,arguments)}if(!arguments.length){l=null}if(l&&l.nodeType){l=window.XMLSerializer?new window.XMLSerializer().serializeToString(l):l.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._data=l;f(this)};c.prototype.abort=function(){if(c.onabort){c.onabort.apply(this,arguments)}if(this.readyState>c.UNSENT){this._aborted=true}this._object.abort();e(this);this.readyState=c.UNSENT;delete this._data};c.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};c.prototype.getResponseHeader=function(l){return this._object.getResponseHeader(l)};c.prototype.setRequestHeader=function(l,m){if(!this._headers){this._headers={}}this._headers[l]=m;return this._object.setRequestHeader(l,m)};c.prototype.addEventListener=function(o,n,m){for(var l=0,p;p=this._listeners[l];l++){if(p[0]==o&&p[1]==n&&p[2]==m){return}}this._listeners.push([o,n,m])};c.prototype.removeEventListener=function(o,n,m){for(var l=0,p;p=this._listeners[l];l++){if(p[0]==o&&p[1]==n&&p[2]==m){break}}if(p){this._listeners.splice(l,1)}};c.prototype.dispatchEvent=function(m){var n={type:m.type,target:this,currentTarget:this,eventPhase:2,bubbles:m.bubbles,cancelable:m.cancelable,timeStamp:m.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};if(n.type=="readystatechange"&&this.onreadystatechange){(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[n])}for(var l=0,o;o=this._listeners[l];l++){if(o[0]==n.type&&!o[2]){(o[1].handleEvent||o[1]).apply(this,[n])}}};c.prototype.toString=function(){return"[object XMLHttpRequest]"};c.toString=function(){return"[XMLHttpRequest]"};function f(l){l._object.send(l._data);if(a&&!l._async){l.readyState=c.OPENED;h(l);while(l.readyState<c.DONE){l.readyState++;b(l);if(l._aborted){return}}}}function b(l){if(c.onreadystatechange){c.onreadystatechange.apply(l)}l.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function i(n){var m=n.responseXML;var l=n.responseText;if(j&&l&&m&&!m.documentElement&&n.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){m=new window.ActiveXObject("Microsoft.XMLDOM");m.async=false;m.validateOnParse=false;m.loadXML(l)}if(m){if((j&&m.parseError!==0)||!m.documentElement||(m.documentElement&&m.documentElement.tagName=="parsererror")){return null}}return m}function h(l){try{l.responseText=l._object.responseText}catch(m){}try{l.responseXML=i(l._object)}catch(m){}try{l.status=l._object.status}catch(m){}try{l.statusText=l._object.statusText}catch(m){}}function e(l){l._object.onreadystatechange=new window.Function}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(l,m){if(!m){m=[]}l.__func=this;l.__func(m[0],m[1],m[2],m[3],m[4]);delete l.__func}}window.CustomXMLHttpRequest=c})();var qq=qq||{};qq.extend=function(b,a){for(var c in a){b[c]=a[c]}};qq.indexOf=function(b,c,d){if(b.indexOf){return b.indexOf(c,d)}d=d||0;var a=b.length;if(d<0){d+=a}for(;d<a;d++){if(d in b&&b[d]===c){return d}}return -1};qq.getUniqueId=(function(){var a=0;return function(){return a++}})();qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!=-1};qq.safari=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Apple")!=-1};qq.chrome=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Google")!=-1};qq.firefox=function(){return(navigator.userAgent.indexOf("Mozilla")!=-1&&navigator.vendor!=undefined&&navigator.vendor=="")};qq.windows=function(){return navigator.platform=="Win32"};qq.attach=function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}return function(){qq.detach(a,c,b)}};qq.detach=function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.attachEvent){a.detachEvent("on"+c,b)}}};qq.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};qq.insertBefore=function(d,c){c.parentNode.insertBefore(d,c)};qq.remove=function(a){a.parentNode.removeChild(a)};qq.contains=function(b,a){if(b==a){return true}if(b.contains){return b.contains(a)}else{return !!(a.compareDocumentPosition(b)&8)}};qq.toElement=(function(){var a=document.createElement("div");return function(c){a.innerHTML=c;var b=a.firstChild;a.removeChild(b);return b}})();qq.css=function(a,b){if(b.opacity!=null){if(typeof a.style.opacity!="string"&&typeof(a.filters)!="undefined"){b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"}}qq.extend(a.style,b)};qq.hasClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");return c.test(b.className)};qq.addClass=function(b,a){if(!qq.hasClass(b,a)){b.className+=" "+a}};qq.removeClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");b.className=b.className.replace(c," ").replace(/^\s+|\s+$/g,"")};qq.setText=function(a,b){a.innerText=b;a.textContent=b};qq.children=function(b){var a=[],c=b.firstChild;while(c){if(c.nodeType==1){a.push(c)}c=c.nextSibling}return a};qq.getByClass=function(d,e){if(d.querySelectorAll){return d.querySelectorAll("."+e)}var b=[];var f=d.getElementsByTagName("*");var a=f.length;for(var c=0;c<a;c++){if(qq.hasClass(f[c],e)){b.push(f[c])}}return b};qq.obj2url=function(f,b,h){var g=[],d="&",e=function(k,j){var l=b?(/\[\]$/.test(b))?b:b+"["+j+"]":j;if((l!="undefined")&&(j!="undefined")){g.push((typeof k==="object")?qq.obj2url(k,l,true):(Object.prototype.toString.call(k)==="[object Function]")?encodeURIComponent(l)+"="+encodeURIComponent(k()):encodeURIComponent(l)+"="+encodeURIComponent(k))}};if(!h&&b){d=(/\?/.test(b))?(/\?$/.test(b))?"":"&":"?";b+="/"+f.qqfile;return b}else{if((Object.prototype.toString.call(f)==="[object Array]")&&(typeof f!="undefined")){for(var c=0,a=f.length;c<a;++c){e(f[c],c)}}else{if((typeof f!="undefined")&&(f!==null)&&(typeof f==="object")){for(var c in f){e(f[c],c)}}else{g.push(encodeURIComponent(b)+"="+encodeURIComponent(f))}}}if(b){return g.join(d)}else{return g.join(d).replace(/^&/,"").replace(/%20/g,"+")}};var qq=qq||{};qq.FileUploaderBasic=function(b){var a=this;this._options={debug:false,action:"/server/upload",params:{},customHeaders:{},button:null,multiple:true,maxConnections:3,disableCancelForFormUploads:false,autoUpload:true,forceMultipart:false,allowedExtensions:[],acceptFiles:null,sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:true,onSubmit:function(d,c){},onComplete:function(e,d,c){},onCancel:function(d,c){},onUpload:function(e,d,c){},onProgress:function(f,e,c,d){},onError:function(e,d,c){},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(c){alert(c)},inputName:"qqfile"};qq.extend(this._options,b);this._wrapCallbacks();qq.extend(this,qq.DisposeSupport);this._filesInProgress=0;this._storedFileIds=[];this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FileUploaderBasic.prototype={log:function(a){if(this._options.debug&&window.console){console.log("[uploader] "+a)}},setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){while(this._storedFileIds.length){this._filesInProgress++;this._handler.upload(this._storedFileIds.shift(),this._options.params)}},clearStoredFiles:function(){this._storedFileIds=[]},_createUploadButton:function(c){var a=this;var b=new qq.UploadButton({element:c,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.acceptFiles,onChange:function(d){a._onInputChange(d)}});this.addDisposer(function(){b.dispose()});return b},_createUploadHandler:function(){var a=this,c;if(qq.UploadHandlerXhr.isSupported()){c="UploadHandlerXhr"}else{c="UploadHandlerForm"}var b=new qq[c]({debug:this._options.debug,action:this._options.action,forceMultipart:this._options.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.customHeaders,inputName:this._options.inputName,demoMode:this._options.demoMode,onProgress:function(g,f,d,e){a._onProgress(g,f,d,e);a._options.onProgress(g,f,d,e)},onComplete:function(f,e,d){a._onComplete(f,e,d);a._options.onComplete(f,e,d)},onCancel:function(e,d){a._onCancel(e,d);a._options.onCancel(e,d)},onError:a._options.onError,onUpload:function(f,e,d){a._onUpload(f,e,d);a._options.onUpload(f,e,d)}});return b},_preventLeaveInProgress:function(){var a=this;this._attach(window,"beforeunload",function(b){if(!a._filesInProgress){return}var b=b||window.event;b.returnValue=a._options.messages.onLeave;return a._options.messages.onLeave})},_onSubmit:function(b,a){if(this._options.autoUpload){this._filesInProgress++}},_onProgress:function(d,c,a,b){},_onComplete:function(d,c,b){this._filesInProgress--;if(!b.success){var a=b.error?b.error:"Upload failure reason unknown";this._options.onError(d,c,a)}},_onCancel:function(c,b){var a=qq.indexOf(this._storedFileIds,c);if(this._options.autoUpload||a<0){this._filesInProgress--}else{if(!this._options.autoUpload){this._storedFileIds.splice(a,1)}}},_onUpload:function(c,b,a){},_onInputChange:function(a){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(a.files)}else{if(this._validateFile(a)){this._uploadFile(a)}}this._button.reset()},_uploadFileList:function(b){if(b.length>0){for(var a=0;a<b.length;a++){if(this._validateFile(b[a])){this._uploadFile(b[a])}else{if(this._options.stopOnFirstInvalidFile){return}}}}else{this._error("noFilesError","")}},_uploadFile:function(a){console.log(a);var c=this._handler.add(a);var b=this._handler.getName(c);if(this._options.onSubmit(c,b)!==false){this._onSubmit(c,b);if(this._options.autoUpload){this._handler.upload(c,this._options.params)}else{this._storeFileForLater(c)}}},_storeFileForLater:function(a){this._storedFileIds.push(a)},_validateFile:function(c){var a,b;if(c.value){a=c.value.replace(/.*(\/|\\)/,"")}else{a=(c.fileName!==null&&c.fileName!==undefined)?c.fileName:c.name;b=(c.fileSize!==null&&c.fileSize!==undefined)?c.fileSize:c.size}if(!this._isAllowedExtension(a)){this._error("typeError",a);return false}else{if(b===0){this._error("emptyError",a);return false}else{if(b&&this._options.sizeLimit&&b>this._options.sizeLimit){this._error("sizeError",a);return false}else{if(b&&b<this._options.minSizeLimit){this._error("minSizeError",a);return false}}}}return true},_error:function(d,e){var c=this._options.messages[d];function b(f,g){c=c.replace(f,g)}var a=this._options.allowedExtensions.join(", ");b("{file}",this._formatFileName(e));b("{extensions}",a);b("{sizeLimit}",this._formatSize(this._options.sizeLimit));b("{minSizeLimit}",this._formatSize(this._options.minSizeLimit));this._options.onError(null,e,c);this._options.showMessage(c)},_formatFileName:function(a){if(a.length>33){a=a.slice(0,19)+"..."+a.slice(-13)}return a},_isAllowedExtension:function(d){var b=(-1!==d.indexOf("."))?d.replace(/.*[.]/,"").toLowerCase():"";var c=this._options.allowedExtensions;if(!c.length){return true}for(var a=0;a<c.length;a++){if(c[a].toLowerCase()==b){return true}}return false},_formatSize:function(a){var b=-1;do{a=a/1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]},_wrapCallbacks:function(){var a,b;a=this;b=function(f,d){try{return f.apply(a,d)}catch(e){a.log("Caught "+e+" in callback: "+f)}};for(var c in this._options){if(/^on[A-Z]/.test(c)){(function(){var d=a._options[c];a._options[c]=function(){return b(d,arguments)}}())}}}};qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,dragText:"Drop files here to upload",extraDropzones:[],hideDropzones:true,disableDefaultDropzone:false,uploadButtonText:"Upload a file",cancelButtonText:"Cancel",failUploadText:"Upload failed",template:'<div class="qq-uploader">'+(!this._options.disableDefaultDropzone?'<div class="qq-upload-drop-area"><span>{dragText}</span></div>':"")+(!this._options.button?'<div class="qq-upload-button">{uploadButtonText}</div>':"")+(!this._options.listElement?'<ul class="qq-upload-list"></ul>':"")+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><span class="qq-upload-failed-text">{failUploadtext}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",size:"qq-upload-size",cancel:"qq-upload-cancel",failText:"qq-upload-failed-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null},extraMessages:{formatProgress:"{percent}% of {total_size}",tooManyFilesError:"You may only drop one file"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:true}});qq.extend(this._options,a);this._wrapCallbacks();qq.extend(this._options.messages,this._options.extraMessages);this._options.template=this._options.template.replace(/\{dragText\}/g,this._options.dragText);this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.uploadButtonText);this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.cancelButtonText);this._options.fileTemplate=this._options.fileTemplate.replace(/\{failUploadtext\}/g,this._options.failUploadText);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;if(!this._button){this._button=this._createUploadButton(this._find(this._element,"button"))}this._bindCancelEvent();this._setupDragDrop()};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype);qq.extend(qq.FileUploader.prototype,{clearStoredFiles:function(){qq.FileUploaderBasic.prototype.clearStoredFiles.apply(this,arguments);this._listElement.innerHTML=""},addExtraDropzone:function(a){this._setupExtraDropzone(a)},removeExtraDropzone:function(c){var a=this._options.extraDropzones;for(var b in a){if(a[b]===c){return this._options.extraDropzones.splice(b,1)}}},_leaving_document_out:function(a){return((qq.chrome()||(qq.safari()&&qq.windows()))&&a.clientX==0&&a.clientY==0)||(qq.firefox()&&!a.relatedTarget)},_storeFileForLater:function(b){qq.FileUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var a=this._getItemByFileId(b);this._find(a,"spinner").style.display="none"},_find:function(c,b){var a=qq.getByClass(c,this._options.classes[b])[0];if(!a){throw new Error("element not found "+b)}return a},_setupExtraDropzone:function(a){this._options.extraDropzones.push(a);this._setupDropzone(a)},_setupDropzone:function(c){var b=this;var a=new qq.UploadDropZone({element:c,onEnter:function(d){qq.addClass(c,b._classes.dropActive);d.stopPropagation()},onLeave:function(d){},onLeaveNotDescendants:function(d){qq.removeClass(c,b._classes.dropActive)},onDrop:function(d){if(b._options.hideDropzones){c.style.display="none"}qq.removeClass(c,b._classes.dropActive);if(d.dataTransfer.files.length>1&&!b._options.multiple){b._error("tooManyFilesError","")}else{b._uploadFileList(d.dataTransfer.files)}}});this.addDisposer(function(){a.dispose()});if(this._options.hideDropzones){c.style.display="none"}},_setupDragDrop:function(){var a=this;if(!this._options.disableDefaultDropzone){var b=this._find(this._element,"drop");this._options.extraDropzones.push(b)}var d=this._options.extraDropzones;var c;for(c=0;c<d.length;c++){this._setupDropzone(d[c])}if(!this._options.disableDefaultDropzone&&!qq.ie()){this._attach(document,"dragenter",function(f){if(qq.hasClass(b,a._classes.dropDisabled)){return}b.style.display="block";for(c=0;c<d.length;c++){d[c].style.display="block"}})}this._attach(document,"dragleave",function(f){if(a._options.hideDropzones&&qq.FileUploader.prototype._leaving_document_out(f)){for(c=0;c<d.length;c++){d[c].style.display="none"}}});qq.attach(document,"drop",function(f){if(a._options.hideDropzones){for(c=0;c<d.length;c++){d[c].style.display="none"}}f.preventDefault()})},_onSubmit:function(b,a){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(b,a)},_onProgress:function(a,c,d,f){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var h=this._getItemByFileId(a);if(d===f){var b=this._find(h,"cancel");b.style.display="none"}var i=this._find(h,"size");i.style.display="inline";var g;var e=Math.round(d/f*100);if(d!=f){g=this._formatProgress(d,f)}else{g=this._formatSize(f)}this._find(h,"progressBar").style.width=e+"%";qq.setText(i,g)},_onComplete:function(d,c,a){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var b=this._getItemByFileId(d);qq.remove(this._find(b,"progressBar"));if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported()){qq.remove(this._find(b,"cancel"))}qq.remove(this._find(b,"spinner"));if(a.success){qq.addClass(b,this._classes.success);if(this._classes.successIcon){this._find(b,"finished").style.display="inline-block";qq.addClass(b,this._classes.successIcon)}}else{qq.addClass(b,this._classes.fail);if(this._classes.failIcon){this._find(b,"finished").style.display="inline-block";qq.addClass(b,this._classes.failIcon)}this._controlFailureTextDisplay(b,a)}},_onUpload:function(e,d,b){qq.FileUploaderBasic.prototype._onUpload.apply(this,arguments);var a=this._getItemByFileId(e);if(qq.UploadHandlerXhr.isSupported()){this._find(a,"progressBar").style.display="block"}var c=this._find(a,"spinner");if(c.style.display=="none"){c.style.display="inline-block"}},_addToList:function(e,d){var b=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var a=this._find(b,"cancel");qq.remove(a)}b.qqFileId=e;var c=this._find(b,"file");qq.setText(c,this._formatFileName(d));this._find(b,"size").style.display="none";if(!this._options.multiple){this._clearList()}this._listElement.appendChild(b)},_clearList:function(){this._listElement.innerHTML="";this.clearStoredFiles()},_getItemByFileId:function(b){var a=this._listElement.firstChild;while(a){if(a.qqFileId==b){return a}a=a.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;this._attach(b,"click",function(f){f=f||window.event;var d=f.target||f.srcElement;if(qq.hasClass(d,a._classes.cancel)){qq.preventDefault(f);var c=d.parentNode;while(c.qqFileId==undefined){c=d=d.parentNode}a._handler.cancel(c.qqFileId);qq.remove(c)}})},_formatProgress:function(d,a){var c=this._options.messages.formatProgress;function b(e,f){c=c.replace(e,f)}b("{percent}",Math.round(d/a*100));b("{total_size}",this._formatSize(a));return c},_controlFailureTextDisplay:function(c,b){var f,d,a,g,e;f=this._options.failedUploadTextDisplay.mode;d=this._options.failedUploadTextDisplay.maxChars;a=this._options.failedUploadTextDisplay.responseProperty;if(f==="custom"){var g=b[a];if(g){if(g.length>d){e=g.substring(0,d)+"..."}qq.setText(this._find(c,"failText"),e||g);if(this._options.failedUploadTextDisplay.enableTooltip){this._showTooltip(c,g)}}else{this.log("'"+a+"' is not a valid property on the server response.")}}else{if(f==="none"){qq.remove(this._find(c,"failText"))}else{if(f!=="default"){this.log("failedUploadTextDisplay.mode value of '"+f+"' is not valid")}}}},_showTooltip:function(a,b){a.title=b}});qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(b){},onLeave:function(b){},onLeaveNotDescendants:function(b){},onDrop:function(b){}};qq.extend(this._options,a);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||(qq.firefox()&&qq.windows())},_disableDropOutside:function(a){if(!qq.UploadDropZone.dropOutsideDisabled){if(this._dragover_should_be_canceled){qq.attach(document,"dragover",function(b){b.preventDefault()})}else{qq.attach(document,"dragover",function(b){if(b.dataTransfer){b.dataTransfer.dropEffect="none";b.preventDefault()}})}qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var a=this;a._attach(a._element,"dragover",function(c){if(!a._isValidFileDrag(c)){return}var b=qq.ie()?null:c.dataTransfer.effectAllowed;if(b=="move"||b=="linkMove"){c.dataTransfer.dropEffect="move"}else{c.dataTransfer.dropEffect="copy"}c.stopPropagation();c.preventDefault()});a._attach(a._element,"dragenter",function(b){if(!a._isValidFileDrag(b)){return}a._options.onEnter(b)});a._attach(a._element,"dragleave",function(c){if(!a._isValidFileDrag(c)){return}a._options.onLeave(c);var b=document.elementFromPoint(c.clientX,c.clientY);if(qq.contains(this,b)){return}a._options.onLeaveNotDescendants(c)});a._attach(a._element,"drop",function(b){if(!a._isValidFileDrag(b)){return}b.preventDefault();a._options.onDrop(b)})},_isValidFileDrag:function(c){if(qq.ie()){return false}var b=c.dataTransfer,a=qq.safari();return b&&b.effectAllowed!="none"&&(b.files||(!a&&b.types.contains&&b.types.contains("Files")))}};qq.UploadButton=function(a){this._options={element:null,multiple:false,acceptFiles:null,name:"file",onChange:function(b){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq.remove(this._input)}qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput()},_createInput:function(){var b=document.createElement("input");if(this._options.multiple){b.setAttribute("multiple","multiple")}if(this._options.acceptFiles){b.setAttribute("accept",this._options.acceptFiles)}b.setAttribute("type","file");b.setAttribute("name",this._options.name);qq.css(b,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(b);var a=this;this._attach(b,"change",function(){a._options.onChange(b)});this._attach(b,"mouseover",function(){qq.addClass(a._element,a._options.hoverClass)});this._attach(b,"mouseout",function(){qq.removeClass(a._element,a._options.hoverClass)});this._attach(b,"focus",function(){qq.addClass(a._element,a._options.focusClass)});this._attach(b,"blur",function(){qq.removeClass(a._element,a._options.focusClass)});if(window.attachEvent){b.setAttribute("tabIndex","-1")}return b}};qq.UploadHandlerAbstract=function(a){this._options={debug:false,action:"/upload.php",maxConnections:999,onProgress:function(e,d,b,c){},onComplete:function(d,c,b){},onCancel:function(c,b){},onUpload:function(d,c,b){}};qq.extend(this._options,a);this._queue=[];this._params=[]};qq.UploadHandlerAbstract.prototype={log:function(a){if(this._options.debug&&window.console){console.log("[uploader] "+a)}},add:function(a){},upload:function(d,b){var a=this._queue.push(d);var c={};qq.extend(c,b);this._params[d]=c;if(a<=this._options.maxConnections){this._upload(d,this._params[d])}},cancel:function(a){this._cancel(a);this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++){this._cancel(this._queue[a])}this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(d){var b=qq.indexOf(this._queue,d);this._queue.splice(b,1);var a=this._options.maxConnections;if(this._queue.length>=a&&b<a){var c=this._queue[a-1];this._upload(c,this._params[c])}}};qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={};this._detach_load_events={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){console.log(a);a.setAttribute("name",this._options.inputName);var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a;if(a.parentNode){qq.remove(a)}return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(b){this._options.onCancel(b,this.getName(b));delete this._inputs[b];delete this._detach_load_events[b];var a=document.getElementById(b);if(a){a.setAttribute("src","javascript:false;");qq.remove(a)}},_upload:function(g,e){this._options.onUpload(g,this.getName(g),false);var b=this._inputs[g];if(!b){throw new Error("file with passed id was not added, or already uploaded or cancelled")}var f=this.getName(g);e[this._options.inputName]=f;var c=this._createIframe(g);var d=this._createForm(c,e);d.appendChild(b);var a=this;this._attachLoadEvent(c,function(){a.log("iframe loaded");var h=a._getIframeContentJSON(c);a._options.onComplete(g,f,h);a._dequeue(g);delete a._inputs[g];setTimeout(function(){a._detach_load_events[g]();delete a._detach_load_events[g];qq.remove(c)},1)});d.submit();qq.remove(d);return g},_attachLoadEvent:function(a,b){this._detach_load_events[a.id]=qq.attach(a,"load",function(){if(!a.parentNode){return}try{if(a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false"){return}}catch(c){}b()})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;var innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+innerHTML);if(innerHTML.slice(0,5).toLowerCase()=="<pre>"&&innerHTML.slice(-6).toLowerCase()=="</pre>"){innerHTML=doc.body.firstChild.firstChild.nodeValue}response=eval("("+innerHTML+")")}catch(err){response={success:false}}return response},_createIframe:function(b){var a=qq.toElement('<iframe src="javascript:false;" name="'+b+'" />');a.setAttribute("id",b);a.style.display="none";document.body.appendChild(a);return a},_createForm:function(a,d){var c=this._options.demoMode?"GET":"POST";var b=qq.toElement('<form method="'+c+'" enctype="multipart/form-data"></form>');var e=qq.obj2url(d,this._options.action);b.setAttribute("action",e);b.setAttribute("target",a.name);b.style.display="none";document.body.appendChild(b);return b}});qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return("multiple" in a&&typeof File!="undefined"&&typeof FormData!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined")};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}return this._files.push(a)-1},getName:function(b){var a=this._files[b];return(a.fileName!==null&&a.fileName!==undefined)?a.fileName:a.name},getSize:function(b){var a=this._files[b];return a.fileSize!=null?a.fileSize:a.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(c,f){this._options.onUpload(c,this.getName(c),true);var e=this._files[c],b=this.getName(c),j=this.getSize(c);this._loaded[c]=0;var h=this._xhrs[c]=new XMLHttpRequest();var i=this;h.upload.onprogress=function(k){if(k.lengthComputable){i._loaded[c]=k.loaded;i._options.onProgress(c,b,k.loaded,k.total)}};h.onreadystatechange=function(){if(h.readyState==4){i._onComplete(c,h)}};f=f||{};f[this._options.inputName]=b;var a=qq.obj2url(f,this._options.action);var g=this._options.demoMode?"GET":"POST";h.open(g,a,true);h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.setRequestHeader("X-File-Name",encodeURIComponent(b));h.setRequestHeader("Cache-Control","no-cache");if(this._options.forceMultipart){var d=new FormData();d.append(this._options.inputName,e);e=d}else{h.setRequestHeader("Content-Type","application/octet-stream");h.setRequestHeader("X-Mime-Type",e.type)}for(key in this._options.customHeaders){h.setRequestHeader(key,this._options.customHeaders[key])}h.send(e)},_onComplete:function(id,xhr){if(!this._files[id]){return}var name=this.getName(id);var size=this.getSize(id);var response;this._options.onProgress(id,name,size,size);this.log("xhr - server response received");this.log("responseText = "+xhr.responseText);try{if(typeof JSON.parse==="function"){response=JSON.parse(xhr.responseText)}else{response=eval("("+xhr.responseText+")")}}catch(err){response={}}if(xhr.status!==200){this._options.onError(id,name,"XHR returned response code "+xhr.status)}this._options.onComplete(id,name,response);this._xhrs[id]=null;this._dequeue(id)},_cancel:function(a){this._options.onCancel(a,this.getName(a));this._files[a]=null;if(this._xhrs[a]){this._xhrs[a].abort();this._xhrs[a]=null}}});qq.DisposeSupport={_disposers:[],dispose:function(){var a;while(a=this._disposers.shift()){a()}},addDisposer:function(a){this._disposers.push(a)},_attach:function(){this.addDisposer(qq.attach.apply(this,arguments))}};"use strict";function DomHandler(a){this.domElement=null;if(typeof a!=="undefined"){this.domElement=a}return this}DomHandler.prototype.contains=function(a){var b=a.parentNode;while(b!=null){if(b==this.domElement){return true}b=b.parentNode}return false};DomHandler.prototype.containsOrIs=function(a){return(this.domElement==a||this.contains(a))};DomHandler.prototype.getViewport=function(){if(typeof window.innerWidth!="undefined"){return{width:window.innerWidth,height:window.innerHeight}}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}else{return{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}}};DomHandler.prototype.addClass=function(a){if($(this.domElement).hasClass(a)){return}if(this.domElement.className){this.domElement.className+=" "}this.domElement.className+=a};DomHandler.prototype.removeClass=function(a){var b=new RegExp("\\b"+a+"\\b");this.domElement.className=this.domElement.className.replace(b,"")};DomHandler.prototype.hasClass=function(a){var b=new RegExp("\\b"+a+"\\b");return b.test(this.domElement.className)};DomHandler.prototype.center=function(){var a={left:(this.getViewport().width-this.domElement.offsetWidth)/2,top:(this.getViewport().height-this.domElement.offsetHeight)/2};this.domElement.style.left=a.left+"px";this.domElement.style.top=a.top+"px"};DomHandler.prototype.getFormValues=function(){var d=[];for(var b=0,c=this.domElement.elements.length;b<c;b++){var a=this.domElement.elements[b];if(a.tagName=="TEXTAREA"||a.tagName=="SELECT"){d[a.name]=a.value}else{if(a.tagName=="INPUT"){if(a.type=="text"||a.type=="hidden"||a.type=="password"){d[a.name]=a.value}else{if(a.type=="radio"&&a.checked){if(!a.value){d[a.name]="on"}else{d[a.name]=a.value}}else{if(a.type=="checkbox"&&a.checked){if(!a.value){d[a.name]="on"}else{d[a.name]=a.value}}}}}}}return d};DomHandler.prototype.closestByTagName=function(b){var a=this.domElement;b=b.toUpperCase();while(a.parentNode){a=a.parentNode;if(a.tagName==b){return a}}};DomHandler.prototype.fadeOut=function(c,b){var a=this.domElement.style.opacity;if(!this.domElement.style.opacity){a=1}a=Math.round(a*100)/100;a-=0.05;if(a<0){a=0}this.domElement.style.opacity=a;if(a==0){c();return}setTimeout(function(){this.fadeOut(c,b)}.bind(this),b)};DomHandler.prototype.on=function(b,c){var a={focus:"focusin",blur:"focusout"};if(window.addEventListener){this.domElement.addEventListener(b,c,typeof a[b]!==undefined)}else{this.domElement.attachEvent("on"+b,c)}};var $=function(a){return new DomHandler(a)};Array.prototype.buildQueryString=function(){var c="",a="";for(var b in this){if(!this.hasOwnProperty(b)){continue}c+=a+encodeURIComponent(b)+"="+encodeURIComponent(this[b]);a="&"}return c};function Popup(){this.activeType=null;this.allowClosing=true;this.dimensions={};this.resetDimensions();this.init()}Popup.prototype.init=function(){if(this.isActive()){var a=this.get().innerHTML;this.get().remove();this.show("requires-password",a,false)}};Popup.prototype.isActive=function(b){var a=this.get();if(a===null||(typeof b!=="undefined"&&this.activeType!=b)){return false}return true};Popup.prototype.setDimensions=function(a){if(typeof a.width!=="undefined"){this.dimensions.width=a.width}if(typeof a.height!=="undefined"){this.dimensions.height=a.height}};Popup.prototype.resetDimensions=function(){this.dimensions={width:null,height:null}};Popup.prototype.show=function(d,e,c){this.activeType=d;if(typeof c!=="undefined"){this.allowClosing=c}var a=document.getElementsByTagName("body")[0],b=document.createElement("div");$(document.getElementById("body")).addClass("inactive");$(b).addClass("popup");b.innerHTML=e;this.setDimensionsOfPopup(b);a.appendChild(b);$(b).center();return b};Popup.prototype.setDimensionsOfPopup=function(a){if(this.dimensions.width!==null){a.style.width=this.dimensions.width+"px"}if(this.dimensions.height!==null){a.style.height=this.dimensions.height+"px"}this.resetDimensions()};Popup.prototype.remove=function(b){var a=this.get();if(a===null){return}if(this.allowClosing===false&&(typeof b==="undefined"||b!==true)){return}document.querySelector("body").removeChild(a);$(document.getElementById("body")).removeClass("inactive")};Popup.prototype.get=function(){return document.querySelector(".popup")};"use strict";function Authentication(){}Authentication.prototype.showPopup=function(a,b){if(a.isActive("login")){return}if(a.isActive()){a.remove()}var c=new CustomXMLHttpRequest();c.onreadystatechange=function(){if(c.readyState<4||c.status!==200){return}if(c.readyState===4){var d=JSON.parse(c.responseText);var e=a.show("login",d.html);e.querySelector('input[name="username"]').focus()}};c.open("GET",b.href+"/json",true);c.send()};Authentication.prototype.login=function(a){var b=$(a).getFormValues();if(!b.username||!b.password){return}var c=new CustomXMLHttpRequest();c.onreadystatechange=function(){if(c.readyState<4||c.status!==200){return}if(c.readyState===4){var d=JSON.parse(c.responseText);if(typeof d.result==="undefined"||d.result!="success"){this.invalidateForm(a)}else{location.reload(true)}}}.bind(this);c.open(a.method,a.action+"/json",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(b.buildQueryString())};Authentication.prototype.invalidateForm=function(b){var c=b.querySelector('input[name="username"]'),a=b.querySelector('input[name="password"]');if(!$(c).hasClass("error")){$(c).addClass("error")}if(!$(a).hasClass("error")){$(a).addClass("error")}a.value="";c.blur();a.blur()};Authentication.prototype.logout=function(a){var b=new CustomXMLHttpRequest();b.onreadystatechange=function(){if(b.readyState<4||b.status!==200){return}if(b.readyState===4){window.location="/"}}.bind(this);b.open("GET",a+"/json",true);b.send()};function Download(){}Download.prototype.verifyPassword=function(a){var b=$(a).getFormValues();if(!b.password){return}var c=new CustomXMLHttpRequest();c.onreadystatechange=function(){if(c.readyState<4||c.status!==200){return}if(c.readyState===4){var d=JSON.parse(c.responseText);if(typeof d.result==="undefined"||d.result!="success"){this.invalidatePasswordForm(a)}else{window.location=d.url}}}.bind(this);c.open(a.method,a.action+"/json",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(b.buildQueryString())};Download.prototype.login=function(a){var b=$(a).getFormValues();if(!b.username||!b.password){return}var c=new CustomXMLHttpRequest();c.onreadystatechange=function(){if(c.readyState<4||c.status!==200){return}if(c.readyState===4){var d=JSON.parse(c.responseText);if(typeof d.result==="undefined"||d.result!="success"){this.invalidateLoginForm(a)}else{window.location=d.url}}}.bind(this);c.open(a.method,a.action+"/json",true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(b.buildQueryString())};Download.prototype.invalidatePasswordForm=function(b){var a=b.querySelector('input[name="password"]');if(!$(a).hasClass("error")){$(a).addClass("error")}a.value="";a.blur()};Download.prototype.invalidateLoginForm=function(b){var c=b.querySelector('input[name="username"]'),a=b.querySelector('input[name="password"]');if(!$(c).hasClass("error")){$(c).addClass("error")}if(!$(a).hasClass("error")){$(a).addClass("error")}a.value="";c.blur();a.blur()};function FixHeight(){this.set()}FixHeight.prototype.set=function(){var e=document.getElementsByTagName("header")[0],d=document.getElementsByTagName("footer")[0],a=document.getElementById("body"),c=document.querySelector(".qq-upload-drop-area");var b=$().getViewport().height-e.offsetHeight-d.offsetHeight;if(b>0){a.style.height=b+"px";if(c!==null){c.style.height=b+"px"}}};function FilesOverview(a){this.page=a}FilesOverview.prototype.load=function(a){this.page.load("files",a)};FilesOverview.prototype.showEditPopup=function(a,b){var c=new CustomXMLHttpRequest();c.onreadystatechange=function(){if(c.readyState<4||c.status!==200){return}if(c.readyState===4){var d=JSON.parse(c.responseText);var g=a.show("file-info",d.html);g.querySelector("input:first-child").focus();var f=g.getElementsByTagName("select")[0];$(f).on("change",function(){var h=$(f).closestByTagName("table");if(f.value=="password"){this.setDisplay(h.querySelectorAll(".password"),"table-row")}else{this.setDisplay(h.querySelectorAll(".password"),"none")}}.bind(this));var e=g.getElementsByTagName("form")[0];$(e).on("submit",function(h){this.edit(e,a);h.preventDefault();h.stopPropagation()}.bind(this))}}.bind(this);c.open("GET",b+"/json",true);c.send()};FilesOverview.prototype.setDisplay=function(c,d){for(var b=0,a=c.length;b<a;b++){c[b].style.display=d}};FilesOverview.prototype.edit=function(b,a){var c=$(b).getFormValues();var d=new CustomXMLHttpRequest();d.onreadystatechange=function(){if(d.readyState<4||d.status!==200){return}if(d.readyState===4){var e=JSON.parse(d.responseText);if(typeof e.errors==="undefined"||e.errors.length){this.invalidateForm(b,e.errors)}else{this.updateView(b);a.remove()}}}.bind(this);d.open(b.method,b.action+"/json",true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.send(c.buildQueryString())};FilesOverview.prototype.invalidateForm=function(b,d){var a=b.querySelector('input[name="password"]'),c=b.querySelector('input[name="password2"]');if(d.indexOf("password")!=-1&&!$(a).hasClass("error")){$(a).addClass("error")}if(d.indexOf("password2")!=-1&&!$(c).hasClass("error")){$(c).addClass("error")}a.value="";c.value="";a.blur();c.blur()};FilesOverview.prototype.updateView=function(d){var b=d.querySelector("[name=name]").value,c=d.querySelector("[name=description]").value,a=d.querySelector("[name=access]").options[d.querySelector("[name=access]").selectedIndex].text,f=d.querySelector("[name=id]").value;var e=document.querySelector('tr[data-id="'+f+'"]');if(e.querySelector(".name").innerText){e.querySelector(".name").innerText=b;e.querySelector(".description").innerText=c;e.querySelector(".access").innerText=a}else{e.querySelector(".name").textContent=b;e.querySelector(".description").textContent=c;e.querySelector(".access").textContent=a}};FilesOverview.prototype.deleteFile=function(a){var b=new CustomXMLHttpRequest();b.onreadystatechange=function(){if(b.readyState<4||b.status!==200){return}if(b.readyState===4){var d=JSON.parse(b.responseText);if(d.result=="success"){var c=$(a.parentNode).closestByTagName("tr");$(c).fadeOut(function(){c.parentNode.removeChild(c)},25)}else{alert("error!")}}}.bind(this);b.open("POST",a.href+"/json",true);b.send()};function Menu(){this.menuElement=document.getElementById("header").querySelector("ul.btn-group");this.init()}Menu.prototype.init=function(){if(this.menuElement===null){return}var c=this.menuElement.querySelectorAll("a");for(var b=0,a=c.length;b<a;b++){if(c[b].pathname==window.location.pathname){this.deactivateAll();this.activateItem(c[b])}}};Menu.prototype.deactivateAll=function(){var c=this.menuElement.querySelectorAll("li");for(var a=0,b=c.length;a<b;a++){$(c[a]).removeClass("active")}};Menu.prototype.activateItem=function(d){var c=this.menuElement.querySelectorAll("li");for(var a=0,b=c.length;a<b;a++){if($(c[a]).containsOrIs(d)){$(c[a]).addClass("active")}}};function Page(a){this.cachedPages={};this.fileUploader=a}Page.prototype.load=function(c,b,a){if(this.isCached(c)){this.render(this.cachedPages[c].title,this.cachedPages[c].html,b);if(typeof a==="undefined"||a!==true){this.invalidateCache(c)}}else{var d=new CustomXMLHttpRequest();d.onreadystatechange=function(){if(d.readyState<4||d.status!==200){return}if(d.readyState===4){if(typeof a!=="undefined"&&a===true){this.cache(c,d.responseText)}else{this.invalidateCache(c)}var e=JSON.parse(d.responseText);this.render(e.title,e.html,b)}}.bind(this)}d.open("GET",b+"/json",true);d.send()};Page.prototype.isCached=function(a){if(this.cachedPages.hasOwnProperty(a)&&this.cachedPages[a]!==null){return true}return false};Page.prototype.cache=function(a,b){this.cachedPages[a]=b};Page.prototype.invalidateCache=function(a){if(this.isCached(a)){this.cachedPages[a]=null}};Page.prototype.getCache=function(a){return this.cachedPages[a]};Page.prototype.render=function(f,e,d){var a=document.getElementById("body"),g=a.querySelector("footer"),b=document.createElement("div");var c=g.cloneNode(true);a.innerHTML=e;a.appendChild(c);this.setTitle(f);this.setHistory(e,f,d);if(window.location.pathname==""||window.location.pathname=="/"){this.fileUploader.enableFileUploader()}};Page.prototype.clearContents=function(a){while(node.hasChildNodes()){node.removeChild(node.lastChild)}};Page.prototype.setTitle=function(a){document.title=a};Page.prototype.setHistory=function(b,c,a){window.history.pushState({html:b,pageTitle:c},"",a)};function Pages(a){this.popup=a}Pages.prototype.load=function(a){if(this.popup.isActive()){this.popup.remove()}var b=new CustomXMLHttpRequest();b.onreadystatechange=function(){if(b.readyState<4||b.status!==200){return}if(b.readyState===4){var c=JSON.parse(b.responseText);this.popup.setDimensions({width:960});this.popup.show("page",c.html)}}.bind(this);b.open("GET",a+"/json",true);b.send()};function FileUploader(){this.enableFileUploader();this.popup=new Popup();this.authentication=new Authentication();this.download=new Download();this.fixHeight=new FixHeight();this.menu=new Menu();this.page=new Page(this);this.pages=new Pages(this.popup);this.filesOverview=new FilesOverview(this.page);this.initializeEventListeners()}FileUploader.prototype.enableFileUploader=function(){var a=document.getElementById("file-upload");if(a===null){return}var b=new qq.FileUploader({element:a,action:"/upload"})};FileUploader.prototype.initializeEventListeners=function(){this.addOnClickListeners();this.addOnSubmitListeners();this.addOnResizeListeners();this.addOnPopState()};FileUploader.prototype.addOnClickListeners=function(){$(document).on("click",function(f){var f=f||window.event,d=f.target||f.srcElement,h=document.getElementById("header"),b=h.querySelector("a.login"),c=h.querySelector("ul.btn-group"),a=document.querySelector("table.file-list"),g=document.getElementsByTagName("footer")[0];if(false||b!==null&&$(b).containsOrIs(d)){this.authentication.showPopup(this.popup,b);f.preventDefault();f.stopPropagation();return}if(c!==null&&$(c).contains(d)){if(d.tagName=="A"){hyperlink=d}else{hyperlink=$(d).closestByTagName("a")}this.menu.deactivateAll();this.menu.activateItem(d);if($(d.hasClass("logout"))){this.authentication.logout(hyperlink.href)}else{this.filesOverview.load(hyperlink.href)}f.preventDefault();f.stopPropagation();return}if(a!==null){if($(d.parentNode).hasClass("edit")){this.filesOverview.showEditPopup(this.popup,d.href);f.preventDefault();f.stopPropagation();return}if($(d.parentNode).hasClass("delete")){this.filesOverview.deleteFile(d);f.preventDefault();f.stopPropagation();return}}if($(g).containsOrIs(d)&&d.tagName=="A"&&d.getAttribute("target")!="_blank"){this.pages.load(d.href);f.preventDefault();f.stopPropagation();return}if(this.popup.isActive&&!$(this.popup.get()).containsOrIs(d)){this.popup.remove()}}.bind(this))};FileUploader.prototype.addOnSubmitListeners=function(){$(document).on("submit",function(b){var b=b||window.event,a=b.target||b.srcElement;if($(a).hasClass("login")){this.authentication.login(a);b.preventDefault();b.stopPropagation();return}if($(a).hasClass("password")){this.download.verifyPassword(a);b.preventDefault();b.stopPropagation();return}if($(a).hasClass("private-login")){this.download.login(a);b.preventDefault();b.stopPropagation();return}}.bind(this))};FileUploader.prototype.addOnResizeListeners=function(){$(window).on("resize",function(a){this.fixHeight.set()}.bind(this))};FileUploader.prototype.addOnPopState=function(){window.onpopstate=function(a){if(a.state){document.getElementById("body").innerHTML=a.state.html;document.title=a.state.pageTitle}}};"use strict";(function(){var a=new FileUploader()}());